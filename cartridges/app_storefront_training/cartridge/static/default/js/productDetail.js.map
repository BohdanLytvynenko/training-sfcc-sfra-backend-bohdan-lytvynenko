{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./cartridges/app_storefront_training/cartridge/client/default/js/product/base.js","webpack:///./cartridges/app_storefront_training/cartridge/client/default/js/product/detail.js","webpack:///./cartridges/app_storefront_training/cartridge/client/default/js/productDetail.js","webpack:///./cartridges/app_storefront_training/cartridge/client/default/js/util.js"],"names":["getPidValue","$el","pid","$","hasClass","length","closest","find","data","text","getQuantitySelector","getQuantitySelected","val","processSwatchValues","attr","$productContainer","values","forEach","attrValue","$attrValue","id","value","$swatchAnchor","parent","selected","addClass","removeClass","url","removeAttr","selectable","processNonSwatchValues","$attr","$defaultOption","resetUrl","updateAttrs","attrs","attrsWithSwatches","indexOf","updateAvailability","response","availabilityValue","availabilityMessages","product","availability","messages","readyToOrder","resources","info_selectforstock","message","trigger","getPromotionsHtml","promotions","html","promotion","details","calloutMsg","getAttributesHtml","attributes","attributeGroup","ID","attribute","label","updateOptions","options","option","$optionEl","valueEl","handleVariantResponse","isChoiceOfBonusProducts","parents","isVaraint","variationAttributes","productType","primaryImageUrls","images","large","imageUrl","idx","eq","$priceSelector","replaceWith","price","empty","$selectButton","updateQuantities","quantities","optionsHtml","map","quantity","join","attributeSelect","selectedValueUrl","container","ajax","method","success","spinner","stop","error","getAddToCartUrl","parseHtml","$html","append","parseHTML","body","footer","children","chooseBonusProducts","start","remove","bonusUrl","bonusChoiceRuleBased","showProductsUrlRuleBased","showProductsUrlListBased","htmlString","maxBonusItems","uuid","pliUUID","addToCartUrl","pageSize","labels","selectprods","dataType","parsedHtml","modal","handlePostCartAdd","messageType","newBonusDiscountLineItem","Object","keys","setTimeout","getChildProducts","childProducts","each","push","parseInt","JSON","stringify","getOptions","$elOption","urlValue","selectedValueId","optionId","toArray","module","exports","methods","editBonusProducts","colorAttribute","document","on","e","preventDefault","currentTarget","href","selectAttribute","addToCart","pidsObj","setPids","qty","form","selectBonusProduct","$choiceOfBonusProduct","maxPids","submittedQty","totalQty","optionID","valueId","selectedBonusProductHtml","removeBonusProduct","$selected","count","enableBonusProductSelection","available","showMoreBonusProducts","addBonusProductsToCart","$readyToOrderBonusProducts","queryString","pidsObject","bonusProducts","qtyOption","productId","errorMessage","msgSuccess","location","reload","base","require","updateAttributesAndDetails","attributesHtml","shortDescription","longDescription","showSpinner","updateAttribute","updateAddToCart","enable","every","item","allAvailable","allReady","sizeChart","$sizeChart","is","type","content","toggleClass","has","target","processInclude","ready","include","key"],"mappings":"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","file":"default\\js\\productDetail.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./cartridges/app_storefront_training/cartridge/client/default/js/productDetail.js\");\n","'use strict';\r\n\r\n/**\r\n * Retrieves the relevant pid value\r\n * @param {jquery} $el - DOM container for a given add to cart button\r\n * @return {string} - value to be used when adding product to cart\r\n */\r\nfunction getPidValue($el) {\r\n    var pid;\r\n\r\n    if ($('#quickViewModal').hasClass('show') && !$('.product-set').length) {\r\n        pid = $($el).closest('.modal-content').find('.product-quickview').data('pid');\r\n    } else if ($('.product-set-detail').length || $('.product-set').length) {\r\n        pid = $($el).closest('.product-detail').find('.product-id').text();\r\n    } else {\r\n        pid = $('.product-detail:not(\".bundle-item\")').data('pid');\r\n    }\r\n\r\n    return pid;\r\n}\r\n\r\n/**\r\n * Retrieve contextual quantity selector\r\n * @param {jquery} $el - DOM container for the relevant quantity\r\n * @return {jquery} - quantity selector DOM container\r\n */\r\nfunction getQuantitySelector($el) {\r\n    return $el && $('.set-items').length\r\n        ? $($el).closest('.product-detail').find('.quantity-select')\r\n        : $('.quantity-select');\r\n}\r\n\r\n/**\r\n * Retrieves the value associated with the Quantity pull-down menu\r\n * @param {jquery} $el - DOM container for the relevant quantity\r\n * @return {string} - value found in the quantity input\r\n */\r\nfunction getQuantitySelected($el) {\r\n    return getQuantitySelector($el).val();\r\n}\r\n\r\n/**\r\n * Process the attribute values for an attribute that has image swatches\r\n *\r\n * @param {Object} attr - Attribute\r\n * @param {string} attr.id - Attribute ID\r\n * @param {Object[]} attr.values - Array of attribute value objects\r\n * @param {string} attr.values.value - Attribute coded value\r\n * @param {string} attr.values.url - URL to de/select an attribute value of the product\r\n * @param {boolean} attr.values.isSelectable - Flag as to whether an attribute value can be\r\n *     selected.  If there is no variant that corresponds to a specific combination of attribute\r\n *     values, an attribute may be disabled in the Product Detail Page\r\n * @param {jQuery} $productContainer - DOM container for a given product\r\n */\r\nfunction processSwatchValues(attr, $productContainer) {\r\n    attr.values.forEach(function (attrValue) {\r\n        var $attrValue = $productContainer.find('[data-attr=\"' + attr.id + '\"] [data-attr-value=\"' +\r\n            attrValue.value + '\"]');\r\n        var $swatchAnchor = $attrValue.parent();\r\n\r\n        if (attrValue.selected) {\r\n            $attrValue.addClass('selected');\r\n        } else {\r\n            $attrValue.removeClass('selected');\r\n        }\r\n\r\n        if (attrValue.url) {\r\n            $swatchAnchor.attr('href', attrValue.url);\r\n        } else {\r\n            $swatchAnchor.removeAttr('href');\r\n        }\r\n\r\n        // Disable if not selectable\r\n        $attrValue.removeClass('selectable unselectable');\r\n\r\n        $attrValue.addClass(attrValue.selectable ? 'selectable' : 'unselectable');\r\n    });\r\n}\r\n\r\n/**\r\n * Process attribute values associated with an attribute that does not have image swatches\r\n *\r\n * @param {Object} attr - Attribute\r\n * @param {string} attr.id - Attribute ID\r\n * @param {Object[]} attr.values - Array of attribute value objects\r\n * @param {string} attr.values.value - Attribute coded value\r\n * @param {string} attr.values.url - URL to de/select an attribute value of the product\r\n * @param {boolean} attr.values.isSelectable - Flag as to whether an attribute value can be\r\n *     selected.  If there is no variant that corresponds to a specific combination of attribute\r\n *     values, an attribute may be disabled in the Product Detail Page\r\n * @param {jQuery} $productContainer - DOM container for a given product\r\n */\r\nfunction processNonSwatchValues(attr, $productContainer) {\r\n    var $attr = '[data-attr=\"' + attr.id + '\"]';\r\n    var $defaultOption = $productContainer.find($attr + ' .select-' + attr.id + ' option:first');\r\n    $defaultOption.attr('value', attr.resetUrl);\r\n\r\n    attr.values.forEach(function (attrValue) {\r\n        var $attrValue = $productContainer\r\n            .find($attr + ' [data-attr-value=\"' + attrValue.value + '\"]');\r\n        $attrValue.attr('value', attrValue.url)\r\n            .removeAttr('disabled');\r\n\r\n        if (!attrValue.selectable) {\r\n            $attrValue.attr('disabled', true);\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Routes the handling of attribute processing depending on whether the attribute has image\r\n *     swatches or not\r\n *\r\n * @param {Object} attrs - Attribute\r\n * @param {string} attr.id - Attribute ID\r\n * @param {jQuery} $productContainer - DOM element for a given product\r\n */\r\nfunction updateAttrs(attrs, $productContainer) {\r\n    // Currently, the only attribute type that has image swatches is Color.\r\n    var attrsWithSwatches = ['color'];\r\n\r\n    attrs.forEach(function (attr) {\r\n        if (attrsWithSwatches.indexOf(attr.id) > -1) {\r\n            processSwatchValues(attr, $productContainer);\r\n        } else {\r\n            processNonSwatchValues(attr, $productContainer);\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Updates the availability status in the Product Detail Page\r\n *\r\n * @param {Object} response - Ajax response object after an\r\n *                            attribute value has been [de]selected\r\n * @param {jQuery} $productContainer - DOM element for a given product\r\n */\r\nfunction updateAvailability(response, $productContainer) {\r\n    var availabilityValue = '';\r\n    var availabilityMessages = response.product.availability.messages;\r\n    if (!response.product.readyToOrder) {\r\n        availabilityValue = '<div>' + response.resources.info_selectforstock + '</div>';\r\n    } else {\r\n        availabilityMessages.forEach(function (message) {\r\n            availabilityValue += '<div>' + message + '</div>';\r\n        });\r\n    }\r\n\r\n    $($productContainer).trigger('product:updateAvailability', {\r\n        product: response.product,\r\n        $productContainer: $productContainer,\r\n        message: availabilityValue,\r\n        resources: response.resources\r\n    });\r\n}\r\n\r\n/**\r\n * Generates html for promotions section\r\n *\r\n * @param {array} promotions - list of promotions\r\n * @return {string} - Compiled HTML\r\n */\r\nfunction getPromotionsHtml(promotions) {\r\n    if (!promotions) {\r\n        return '';\r\n    }\r\n\r\n    var html = '';\r\n\r\n    promotions.forEach(function (promotion) {\r\n        html += '<div class=\"callout\" title=\"' + promotion.details + '\">' + promotion.calloutMsg +\r\n            '</div>';\r\n    });\r\n\r\n    return html;\r\n}\r\n\r\n/**\r\n * Generates html for product attributes section\r\n *\r\n * @param {array} attributes - list of attributes\r\n * @return {string} - Compiled HTML\r\n */\r\nfunction getAttributesHtml(attributes) {\r\n    if (!attributes) {\r\n        return '';\r\n    }\r\n\r\n    var html = '';\r\n\r\n    attributes.forEach(function (attributeGroup) {\r\n        if (attributeGroup.ID === 'mainAttributes') {\r\n            attributeGroup.attributes.forEach(function (attribute) {\r\n                html += '<div class=\"attribute-values\">' + attribute.label + ': '\r\n                    + attribute.value + '</div>';\r\n            });\r\n        }\r\n    });\r\n\r\n    return html;\r\n}\r\n\r\n/**\r\n * @typedef UpdatedOptionValue\r\n * @type Object\r\n * @property {string} id - Option value ID for look up\r\n * @property {string} url - Updated option value selection URL\r\n */\r\n\r\n/**\r\n * @typedef OptionSelectionResponse\r\n * @type Object\r\n * @property {string} priceHtml - Updated price HTML code\r\n * @property {Object} options - Updated Options\r\n * @property {string} options.id - Option ID\r\n * @property {UpdatedOptionValue[]} options.values - Option values\r\n */\r\n\r\n/**\r\n * Updates DOM using post-option selection Ajax response\r\n *\r\n * @param {OptionSelectionResponse} options - Ajax response options from selecting a product option\r\n * @param {jQuery} $productContainer - DOM element for current product\r\n */\r\nfunction updateOptions(options, $productContainer) {\r\n    options.forEach(function (option) {\r\n        var $optionEl = $productContainer.find('.product-option[data-option-id*=\"' + option.id\r\n            + '\"]');\r\n        option.values.forEach(function (value) {\r\n            var valueEl = $optionEl.find('option[data-value-id*=\"' + value.id + '\"]');\r\n            valueEl.val(value.url);\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * Parses JSON from Ajax call made whenever an attribute value is [de]selected\r\n * @param {Object} response - response from Ajax call\r\n * @param {Object} response.product - Product object\r\n * @param {string} response.product.id - Product ID\r\n * @param {Object[]} response.product.variationAttributes - Product attributes\r\n * @param {Object[]} response.product.images - Product images\r\n * @param {boolean} response.product.hasRequiredAttrsSelected - Flag as to whether all required\r\n *     attributes have been selected.  Used partially to\r\n *     determine whether the Add to Cart button can be enabled\r\n * @param {jQuery} $productContainer - DOM element for a given product.\r\n */\r\nfunction handleVariantResponse(response, $productContainer) {\r\n    var isChoiceOfBonusProducts =\r\n        $productContainer.parents('.choose-bonus-product-dialog').length > 0;\r\n    var isVaraint;\r\n    if (response.product.variationAttributes) {\r\n        updateAttrs(response.product.variationAttributes, $productContainer);\r\n        isVaraint = response.product.productType === 'variant';\r\n        if (isChoiceOfBonusProducts && isVaraint) {\r\n            $productContainer.parent('.bonus-product-item')\r\n                .data('pid', response.product.id);\r\n\r\n            $productContainer.parent('.bonus-product-item')\r\n                .data('ready-to-order', response.product.readyToOrder);\r\n        }\r\n    }\r\n\r\n    // Update primary images\r\n    var primaryImageUrls = response.product.images;\r\n    primaryImageUrls.large.forEach(function (imageUrl, idx) {\r\n        $productContainer.find('.primary-images').find('img').eq(idx)\r\n            .attr('src', imageUrl.url);\r\n    });\r\n\r\n    // Update pricing\r\n    if (!isChoiceOfBonusProducts) {\r\n        var $priceSelector = $('.prices .price', $productContainer).length\r\n            ? $('.prices .price', $productContainer)\r\n            : $('.prices .price');\r\n        $priceSelector.replaceWith(response.product.price.html);\r\n    }\r\n\r\n    // Update promotions\r\n    $('.promotions').empty().html(getPromotionsHtml(response.product.promotions));\r\n\r\n    updateAvailability(response, $productContainer);\r\n\r\n    if (isChoiceOfBonusProducts) {\r\n        var $selectButton = $productContainer.find('.select-bonus-product');\r\n        $selectButton.trigger('bonusproduct:updateSelectButton', {\r\n            product: response.product, $productContainer: $productContainer\r\n        });\r\n    } else {\r\n        // Enable \"Add to Cart\" button if all required attributes have been selected\r\n        $('button.add-to-cart, button.add-to-cart-global, button.update-cart-product-global').trigger('product:updateAddToCart', {\r\n            product: response.product, $productContainer: $productContainer\r\n        }).trigger('product:statusUpdate', response.product);\r\n    }\r\n\r\n    // Update attributes\r\n    $productContainer.find('.main-attributes').empty()\r\n        .html(getAttributesHtml(response.product.attributes));\r\n}\r\n\r\n/**\r\n * @typespec UpdatedQuantity\r\n * @type Object\r\n * @property {boolean} selected - Whether the quantity has been selected\r\n * @property {string} value - The number of products to purchase\r\n * @property {string} url - Compiled URL that specifies variation attributes, product ID, options,\r\n *     etc.\r\n */\r\n\r\n/**\r\n * Updates the quantity DOM elements post Ajax call\r\n * @param {UpdatedQuantity[]} quantities -\r\n * @param {jQuery} $productContainer - DOM container for a given product\r\n */\r\nfunction updateQuantities(quantities, $productContainer) {\r\n    if (!($productContainer.parent('.bonus-product-item').length > 0)) {\r\n        var optionsHtml = quantities.map(function (quantity) {\r\n            var selected = quantity.selected ? ' selected ' : '';\r\n            return '<option value=\"' + quantity.value + '\"  data-url=\"' + quantity.url + '\"' +\r\n                selected + '>' + quantity.value + '</option>';\r\n        }).join('');\r\n        getQuantitySelector($productContainer).empty().html(optionsHtml);\r\n    }\r\n}\r\n\r\n/**\r\n * updates the product view when a product attribute is selected or deselected or when\r\n *         changing quantity\r\n * @param {string} selectedValueUrl - the Url for the selected variation value\r\n * @param {jQuery} $productContainer - DOM element for current product\r\n */\r\nfunction attributeSelect(selectedValueUrl, $productContainer) {\r\n    if (selectedValueUrl) {\r\n        $('body').trigger('product:beforeAttributeSelect',\r\n            { url: selectedValueUrl, container: $productContainer });\r\n\r\n        $.ajax({\r\n            url: selectedValueUrl,\r\n            method: 'GET',\r\n            success: function (data) {\r\n                handleVariantResponse(data, $productContainer);\r\n                updateOptions(data.product.options, $productContainer);\r\n                updateQuantities(data.product.quantities, $productContainer);\r\n                $('body').trigger('product:afterAttributeSelect',\r\n                    { data: data, container: $productContainer });\r\n                $.spinner().stop();\r\n            },\r\n            error: function () {\r\n                $.spinner().stop();\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Retrieves url to use when adding a product to the cart\r\n *\r\n * @return {string} - The provided URL to use when adding a product to the cart\r\n */\r\nfunction getAddToCartUrl() {\r\n    return $('.add-to-cart-url').val();\r\n}\r\n\r\n/**\r\n * Parses the html for a modal window\r\n * @param {string} html - representing the body and footer of the modal window\r\n *\r\n * @return {Object} - Object with properties body and footer.\r\n */\r\nfunction parseHtml(html) {\r\n    var $html = $('<div>').append($.parseHTML(html));\r\n\r\n    var body = $html.find('.choice-of-bonus-product');\r\n    var footer = $html.find('.modal-footer').children();\r\n\r\n    return { body: body, footer: footer };\r\n}\r\n\r\n/**\r\n * Retrieves url to use when adding a product to the cart\r\n *\r\n * @param {Object} data - data object used to fill in dynamic portions of the html\r\n */\r\nfunction chooseBonusProducts(data) {\r\n    $('.modal-body').spinner().start();\r\n\r\n    if ($('#chooseBonusProductModal').length !== 0) {\r\n        $('#chooseBonusProductModal').remove();\r\n    }\r\n    var bonusUrl;\r\n    if (data.bonusChoiceRuleBased) {\r\n        bonusUrl = data.showProductsUrlRuleBased;\r\n    } else {\r\n        bonusUrl = data.showProductsUrlListBased;\r\n    }\r\n\r\n    var htmlString = '<!-- Modal -->'\r\n        + '<div class=\"modal fade\" id=\"chooseBonusProductModal\" role=\"dialog\">'\r\n        + '<div class=\"modal-dialog choose-bonus-product-dialog\" '\r\n        + 'data-total-qty=\"' + data.maxBonusItems + '\"'\r\n        + 'data-UUID=\"' + data.uuid + '\"'\r\n        + 'data-pliUUID=\"' + data.pliUUID + '\"'\r\n        + 'data-addToCartUrl=\"' + data.addToCartUrl + '\"'\r\n        + 'data-pageStart=\"0\"'\r\n        + 'data-pageSize=\"' + data.pageSize + '\"'\r\n        + 'data-moreURL=\"' + data.showProductsUrlRuleBased + '\"'\r\n        + 'data-bonusChoiceRuleBased=\"' + data.bonusChoiceRuleBased + '\">'\r\n        + '<!-- Modal content-->'\r\n        + '<div class=\"modal-content\">'\r\n        + '<div class=\"modal-header\">'\r\n        + '    <span class=\"\">' + data.labels.selectprods + '</span>'\r\n        + '    <button type=\"button\" class=\"close pull-right\" data-dismiss=\"modal\">&times;</button>'\r\n        + '</div>'\r\n        + '<div class=\"modal-body\"></div>'\r\n        + '<div class=\"modal-footer\"></div>'\r\n        + '</div>'\r\n        + '</div>'\r\n        + '</div>';\r\n    $('body').append(htmlString);\r\n    $('.modal-body').spinner().start();\r\n\r\n    $.ajax({\r\n        url: bonusUrl,\r\n        method: 'GET',\r\n        dataType: 'html',\r\n        success: function (html) {\r\n            var parsedHtml = parseHtml(html);\r\n            $('#chooseBonusProductModal .modal-body').empty();\r\n            $('#chooseBonusProductModal .modal-body').html(parsedHtml.body);\r\n            $('#chooseBonusProductModal .modal-footer').html(parsedHtml.footer);\r\n            $('#chooseBonusProductModal').modal('show');\r\n            $.spinner().stop();\r\n        },\r\n        error: function () {\r\n            $.spinner().stop();\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Updates the Mini-Cart quantity value after the customer has pressed the \"Add to Cart\" button\r\n * @param {string} response - ajax response from clicking the add to cart button\r\n */\r\nfunction handlePostCartAdd(response) {\r\n    $('.minicart').trigger('count:update', response);\r\n    var messageType = response.error ? 'alert-danger' : 'alert-success';\r\n    // show add to cart toast\r\n    if (response.newBonusDiscountLineItem\r\n        && Object.keys(response.newBonusDiscountLineItem).length !== 0) {\r\n        chooseBonusProducts(response.newBonusDiscountLineItem);\r\n    } else {\r\n        if ($('.add-to-cart-messages').length === 0) {\r\n            $('body').append(\r\n            '<div class=\"add-to-cart-messages\"></div>'\r\n            );\r\n        }\r\n\r\n        $('.add-to-cart-messages').append(\r\n            '<div class=\"alert ' + messageType + ' add-to-basket-alert text-center\" role=\"alert\">'\r\n            + response.message\r\n            + '</div>'\r\n        );\r\n\r\n        setTimeout(function () {\r\n            $('.add-to-basket-alert').remove();\r\n        }, 5000);\r\n    }\r\n}\r\n\r\n/**\r\n * Retrieves the bundle product item ID's for the Controller to replace bundle master product\r\n * items with their selected variants\r\n *\r\n * @return {string[]} - List of selected bundle product item ID's\r\n */\r\nfunction getChildProducts() {\r\n    var childProducts = [];\r\n    $('.bundle-item').each(function () {\r\n        childProducts.push({\r\n            pid: $(this).find('.product-id').text(),\r\n            quantity: parseInt($(this).find('label.quantity').data('quantity'), 10)\r\n        });\r\n    });\r\n\r\n    return childProducts.length ? JSON.stringify(childProducts) : [];\r\n}\r\n\r\n/**\r\n * Retrieve product options\r\n *\r\n * @param {jQuery} $productContainer - DOM element for current product\r\n * @return {string} - Product options and their selected values\r\n */\r\nfunction getOptions($productContainer) {\r\n    var options = $productContainer\r\n        .find('.product-option')\r\n        .map(function () {\r\n            var $elOption = $(this).find('.options-select');\r\n            var urlValue = $elOption.val();\r\n            var selectedValueId = $elOption.find('option[value=\"' + urlValue + '\"]')\r\n                .data('value-id');\r\n            return {\r\n                optionId: $(this).data('option-id'),\r\n                selectedValueId: selectedValueId\r\n            };\r\n        }).toArray();\r\n\r\n    return JSON.stringify(options);\r\n}\r\n\r\nmodule.exports = {\r\n    attributeSelect: attributeSelect,\r\n    methods: {\r\n        editBonusProducts: function (data) {\r\n            chooseBonusProducts(data);\r\n        }\r\n    },\r\n    colorAttribute: function () {\r\n        $(document).on('click', '[data-attr=\"color\"] a', function (e) {\r\n            e.preventDefault();\r\n\r\n            if ($(this).attr('disabled')) {\r\n                return;\r\n            }\r\n            var $productContainer = $(this).closest('.set-item');\r\n            if (!$productContainer.length) {\r\n                $productContainer = $(this).closest('.product-detail');\r\n            }\r\n\r\n            attributeSelect(e.currentTarget.href, $productContainer);\r\n        });\r\n    },\r\n\r\n    selectAttribute: function () {\r\n        $(document).on('change', 'select[class*=\"select-\"], .options-select', function (e) {\r\n            e.preventDefault();\r\n\r\n            var $productContainer = $(this).closest('.set-item');\r\n            if (!$productContainer.length) {\r\n                $productContainer = $(this).closest('.product-detail');\r\n            }\r\n            attributeSelect(e.currentTarget.value, $productContainer);\r\n        });\r\n    },\r\n\r\n    availability: function () {\r\n        $(document).on('change', '.quantity-select', function (e) {\r\n            e.preventDefault();\r\n\r\n            var $productContainer = $(this).closest('.product-detail');\r\n            if (!$productContainer.length) {\r\n                $productContainer = $(this).closest('.modal-content').find('.product-quickview');\r\n            }\r\n\r\n            if ($('.bundle-items', $productContainer).length === 0) {\r\n                attributeSelect($(e.currentTarget).find('option:selected').data('url'),\r\n                    $productContainer);\r\n            }\r\n        });\r\n    },\r\n\r\n    addToCart: function () {\r\n        $(document).on('click', 'button.add-to-cart, button.add-to-cart-global', function () {\r\n            var addToCartUrl;\r\n            var pid;\r\n            var pidsObj;\r\n            var setPids;\r\n\r\n            $('body').trigger('product:beforeAddToCart', this);\r\n\r\n            if ($('.set-items').length && $(this).hasClass('add-to-cart-global')) {\r\n                setPids = [];\r\n\r\n                $('.product-detail').each(function () {\r\n                    if (!$(this).hasClass('product-set-detail')) {\r\n                        setPids.push({\r\n                            pid: $(this).find('.product-id').text(),\r\n                            qty: $(this).find('.quantity-select').val(),\r\n                            options: getOptions($(this))\r\n                        });\r\n                    }\r\n                });\r\n                pidsObj = JSON.stringify(setPids);\r\n            }\r\n\r\n            pid = getPidValue($(this));\r\n\r\n            var $productContainer = $(this).closest('.product-detail');\r\n            if (!$productContainer.length) {\r\n                $productContainer = $(this).closest('.quick-view-dialog').find('.product-detail');\r\n            }\r\n\r\n            addToCartUrl = getAddToCartUrl();\r\n\r\n            var form = {\r\n                pid: pid,\r\n                pidsObj: pidsObj,\r\n                childProducts: getChildProducts(),\r\n                quantity: getQuantitySelected($(this))\r\n            };\r\n\r\n            if (!$('.bundle-item').length) {\r\n                form.options = getOptions($productContainer);\r\n            }\r\n\r\n            $(this).trigger('updateAddToCartFormData', form);\r\n            if (addToCartUrl) {\r\n                $.ajax({\r\n                    url: addToCartUrl,\r\n                    method: 'POST',\r\n                    data: form,\r\n                    success: function (data) {\r\n                        handlePostCartAdd(data);\r\n                        $('body').trigger('product:afterAddToCart', data);\r\n                        $.spinner().stop();\r\n                    },\r\n                    error: function () {\r\n                        $.spinner().stop();\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    selectBonusProduct: function () {\r\n        $(document).on('click', '.select-bonus-product', function () {\r\n            var $choiceOfBonusProduct = $(this).parents('.choice-of-bonus-product');\r\n            var pid = $(this).data('pid');\r\n            var maxPids = $('.choose-bonus-product-dialog').data('total-qty');\r\n            var submittedQty = parseInt($(this).parents('.choice-of-bonus-product').find('.bonus-quantity-select').val(), 10);\r\n            var totalQty = 0;\r\n            $.each($('#chooseBonusProductModal .selected-bonus-products .selected-pid'), function () {\r\n                totalQty += $(this).data('qty');\r\n            });\r\n            totalQty += submittedQty;\r\n            var optionID = $(this).parents('.choice-of-bonus-product').find('.product-option').data('option-id');\r\n            var valueId = $(this).parents('.choice-of-bonus-product').find('.options-select option:selected').data('valueId');\r\n            if (totalQty <= maxPids) {\r\n                var selectedBonusProductHtml = ''\r\n                + '<div class=\"selected-pid row\" '\r\n                + 'data-pid=\"' + pid + '\"'\r\n                + 'data-qty=\"' + submittedQty + '\"'\r\n                + 'data-optionID=\"' + (optionID || '') + '\"'\r\n                + 'data-option-selected-value=\"' + (valueId || '') + '\"'\r\n                + '>'\r\n                + '<div class=\"col-sm-11 col-9 bonus-product-name\" >'\r\n                + $choiceOfBonusProduct.find('.product-name').html()\r\n                + '</div>'\r\n                + '<div class=\"col-1\"><i class=\"fa fa-times\" aria-hidden=\"true\"></i></div>'\r\n                + '</div>'\r\n                ;\r\n                $('#chooseBonusProductModal .selected-bonus-products').append(selectedBonusProductHtml);\r\n                $('.pre-cart-products').html(totalQty);\r\n                $('.selected-bonus-products .bonus-summary').removeClass('alert-danger');\r\n            } else {\r\n                $('.selected-bonus-products .bonus-summary').addClass('alert-danger');\r\n            }\r\n        });\r\n    },\r\n    removeBonusProduct: function () {\r\n        $(document).on('click', '.selected-pid', function () {\r\n            $(this).remove();\r\n            var $selected = $('#chooseBonusProductModal .selected-bonus-products .selected-pid');\r\n            var count = 0;\r\n            if ($selected.length) {\r\n                $selected.each(function () {\r\n                    count += parseInt($(this).data('qty'), 10);\r\n                });\r\n            }\r\n\r\n            $('.pre-cart-products').html(count);\r\n            $('.selected-bonus-products .bonus-summary').removeClass('alert-danger');\r\n        });\r\n    },\r\n    enableBonusProductSelection: function () {\r\n        $('body').on('bonusproduct:updateSelectButton', function (e, response) {\r\n            $('button.select-bonus-product', response.$productContainer).attr('disabled',\r\n                (!response.product.readyToOrder || !response.product.available));\r\n            var pid = response.product.id;\r\n            $('button.select-bonus-product').data('pid', pid);\r\n        });\r\n    },\r\n    showMoreBonusProducts: function () {\r\n        $(document).on('click', '.show-more-bonus-products', function () {\r\n            var url = $(this).data('url');\r\n            $('.modal-content').spinner().start();\r\n            $.ajax({\r\n                url: url,\r\n                method: 'GET',\r\n                success: function (html) {\r\n                    var parsedHtml = parseHtml(html);\r\n                    $('.modal-body').append(parsedHtml.body);\r\n                    $('.show-more-bonus-products:first').remove();\r\n                    $('.modal-content').spinner().stop();\r\n                },\r\n                error: function () {\r\n                    $('.modal-content').spinner().stop();\r\n                }\r\n            });\r\n        });\r\n    },\r\n    addBonusProductsToCart: function () {\r\n        $(document).on('click', '.add-bonus-products', function () {\r\n            var $readyToOrderBonusProducts = $('.choose-bonus-product-dialog .selected-pid');\r\n            var queryString = '?pids=';\r\n            var url = $('.choose-bonus-product-dialog').data('addtocarturl');\r\n            var pidsObject = {\r\n                bonusProducts: []\r\n            };\r\n\r\n            $.each($readyToOrderBonusProducts, function () {\r\n                var qtyOption =\r\n                    parseInt($(this)\r\n                        .data('qty'), 10);\r\n\r\n                var option = null;\r\n                if (qtyOption > 0) {\r\n                    if ($(this).data('optionid') && $(this).data('option-selected-value')) {\r\n                        option = {};\r\n                        option.optionId = $(this).data('optionid');\r\n                        option.productId = $(this).data('pid');\r\n                        option.selectedValueId = $(this).data('option-selected-value');\r\n                    }\r\n                    pidsObject.bonusProducts.push({\r\n                        pid: $(this).data('pid'),\r\n                        qty: qtyOption,\r\n                        options: [option]\r\n                    });\r\n                    pidsObject.totalQty = parseInt($('.pre-cart-products').html(), 10);\r\n                }\r\n            });\r\n            queryString += JSON.stringify(pidsObject);\r\n            queryString = queryString + '&uuid=' + $('.choose-bonus-product-dialog').data('uuid');\r\n            queryString = queryString + '&pliuuid=' + $('.choose-bonus-product-dialog').data('pliuuid');\r\n            $.spinner().start();\r\n            $.ajax({\r\n                url: url + queryString,\r\n                method: 'POST',\r\n                success: function (data) {\r\n                    $.spinner().stop();\r\n                    if (data.error) {\r\n                        $('.error-choice-of-bonus-products')\r\n                        .html(data.errorMessage);\r\n                    } else {\r\n                        $('.configure-bonus-product-attributes').html(data);\r\n                        $('.bonus-products-step2').removeClass('hidden-xl-down');\r\n                        $('#chooseBonusProductModal').modal('hide');\r\n\r\n                        if ($('.add-to-cart-messages').length === 0) {\r\n                            $('body').append(\r\n                            '<div class=\"add-to-cart-messages\"></div>'\r\n                         );\r\n                        }\r\n                        $('.minicart-quantity').html(data.totalQty);\r\n                        $('.add-to-cart-messages').append(\r\n                            '<div class=\"alert alert-success add-to-basket-alert text-center\"'\r\n                            + ' role=\"alert\">'\r\n                            + data.msgSuccess + '</div>'\r\n                        );\r\n                        setTimeout(function () {\r\n                            $('.add-to-basket-alert').remove();\r\n                            if ($('.cart-page').length) {\r\n                                location.reload();\r\n                            }\r\n                        }, 3000);\r\n                    }\r\n                },\r\n                error: function () {\r\n                    $.spinner().stop();\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    getPidValue: getPidValue\r\n};\r\n","'use strict';\r\nvar base = require('./base');\r\n\r\nmodule.exports = {\r\n    availability: base.availability,\r\n\r\n    addToCart: base.addToCart,\r\n\r\n    updateAttributesAndDetails: function () {\r\n        $('body').on('product:statusUpdate', function (e, data) {\r\n            var $productContainer = $('.product-detail[data-pid=\"' + data.id + '\"]');\r\n\r\n            $productContainer.find('.description-and-detail .product-attributes')\r\n                .empty()\r\n                .html(data.attributesHtml);\r\n\r\n            if (data.shortDescription) {\r\n                $productContainer.find('.description-and-detail .description')\r\n                    .removeClass('hidden-xl-down');\r\n                $productContainer.find('.description-and-detail .description .content')\r\n                    .empty()\r\n                    .html(data.shortDescription);\r\n            } else {\r\n                $productContainer.find('.description-and-detail .description')\r\n                    .addClass('hidden-xl-down');\r\n            }\r\n\r\n            if (data.longDescription) {\r\n                $productContainer.find('.description-and-detail .details')\r\n                    .removeClass('hidden-xl-down');\r\n                $productContainer.find('.description-and-detail .details .content')\r\n                    .empty()\r\n                    .html(data.longDescription);\r\n            } else {\r\n                $productContainer.find('.description-and-detail .details')\r\n                    .addClass('hidden-xl-down');\r\n            }\r\n        });\r\n    },\r\n\r\n    showSpinner: function () {\r\n        $('body').on('product:beforeAddToCart product:beforeAttributeSelect', function () {\r\n            $.spinner().start();\r\n        });\r\n    },\r\n    updateAttribute: function () {\r\n        $('body').on('product:afterAttributeSelect', function (e, response) {\r\n            if ($('.product-detail>.bundle-items').length) {\r\n                response.container.data('pid', response.data.product.id);\r\n                response.container.find('.product-id').text(response.data.product.id);\r\n            } else if ($('.product-set-detail').eq(0)) {\r\n                response.container.data('pid', response.data.product.id);\r\n                response.container.find('.product-id').text(response.data.product.id);\r\n            } else {\r\n                $('.product-id').text(response.data.product.id);\r\n                $('.product-detail:not(\".bundle-item\")').data('pid', response.data.product.id);\r\n            }\r\n        });\r\n    },\r\n    updateAddToCart: function () {\r\n        $('body').on('product:updateAddToCart', function (e, response) {\r\n            // update local add to cart (for sets)\r\n            $('button.add-to-cart', response.$productContainer).attr('disabled',\r\n                (!response.product.readyToOrder || !response.product.available));\r\n\r\n            var enable = $('.product-availability').toArray().every(function (item) {\r\n                return $(item).data('available') && $(item).data('ready-to-order');\r\n            });\r\n            $('button.add-to-cart-global').attr('disabled', !enable);\r\n        });\r\n    },\r\n    updateAvailability: function () {\r\n        $('body').on('product:updateAvailability', function (e, response) {\r\n            $('div.availability', response.$productContainer)\r\n                .data('ready-to-order', response.product.readyToOrder)\r\n                .data('available', response.product.available);\r\n\r\n            $('.availability-msg', response.$productContainer)\r\n                .empty().html(response.message);\r\n\r\n            if ($('.global-availability').length) {\r\n                var allAvailable = $('.product-availability').toArray()\r\n                    .every(function (item) { return $(item).data('available'); });\r\n\r\n                var allReady = $('.product-availability').toArray()\r\n                    .every(function (item) { return $(item).data('ready-to-order'); });\r\n\r\n                $('.global-availability')\r\n                    .data('ready-to-order', allReady)\r\n                    .data('available', allAvailable);\r\n\r\n                $('.global-availability .availability-msg').empty()\r\n                    .html(allReady ? response.message : response.resources.info_selectforstock);\r\n            }\r\n        });\r\n    },\r\n    sizeChart: function () {\r\n        var $sizeChart = $('.size-chart-collapsible');\r\n        $('.size-chart a').on('click', function (e) {\r\n            e.preventDefault();\r\n            var url = $(this).attr('href');\r\n            if ($sizeChart.is(':empty')) {\r\n                $.ajax({\r\n                    url: url,\r\n                    type: 'get',\r\n                    dataType: 'json',\r\n                    success: function (data) {\r\n                        $sizeChart.append(data.content);\r\n                    }\r\n                });\r\n            }\r\n            $sizeChart.toggleClass('active');\r\n        });\r\n\r\n        $('body').on('click touchstart', function (e) {\r\n            if ($('.size-chart').has(e.target).length <= 0) {\r\n                $sizeChart.removeClass('active');\r\n            }\r\n        });\r\n    }\r\n};\r\n","'use strict';\r\n\r\nvar processInclude = require('./util');\r\n\r\n$(document).ready(function () {\r\n    processInclude(require('./product/detail'));\r\n});\r\n","'use strict';\r\n\r\nmodule.exports = function (include) {\r\n    if (typeof include === 'function') {\r\n        include();\r\n    } else if (typeof include === 'object') {\r\n        Object.keys(include).forEach(function (key) {\r\n            if (typeof include[key] === 'function') {\r\n                include[key]();\r\n            }\r\n        });\r\n    }\r\n};\r\n"],"sourceRoot":""}